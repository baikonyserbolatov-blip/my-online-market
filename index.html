<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Market ‚Äî –ø—Ä–æ–¥–∞–∂–∞ –∏–¥–µ–π –∏ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∏</title>
<style>
:root{
  --bg:#0f1724;
  --card-bg:#0b1220;
  --accent1:#6EE7B7;
  --accent2:#60A5FA;
  --glass: rgba(255,255,255,0.04);
  --white: #f8fafc;
  --muted: #b6c2d1;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Arial,system-ui;background:linear-gradient(180deg,#071126 0%, #071430 60%);color:var(--white);-webkit-font-smoothing:antialiased}
.container{max-width:1100px;margin:24px auto;padding:20px}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent2),var(--accent1));display:flex;align-items:center;justify-content:center;font-weight:700;color:#04233b}
.title{font-size:20px;font-weight:700}
.menu{display:flex;gap:10px}
.btn{background:linear-gradient(90deg,var(--accent2),var(--accent1));border:none;padding:8px 14px;border-radius:10px;color:#021426;cursor:pointer;font-weight:600}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:8px 12px;border-radius:10px;color:var(--white);cursor:pointer}
.grid{display:grid;grid-template-columns:1fr 320px;gap:20px;margin-top:18px}
.main{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:18px;border-radius:14px;min-height:520px}
.sidebar{padding:18px;border-radius:14px;background:var(--card-bg);box-shadow:0 6px 24px rgba(2,6,23,0.6)}
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.tabs{display:flex;gap:8px}
.tab{padding:8px 12px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.04);cursor:pointer}
.tab.active{background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#021426;border:0}
.hero{display:flex;gap:18px;align-items:center;padding:18px;border-radius:12px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))}
.hero .text{flex:1;text-align:left}
.hero h2{margin:0;font-size:22px}
.hero p{margin:6px 0;color:var(--muted)}
.hero .cta{margin-top:10px}
.card-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}
.item{background:var(--glass);padding:12px;border-radius:12px;position:relative;overflow:hidden;min-height:160px;display:flex;gap:12px}
.item .left{width:120px;flex-shrink:0;display:flex;align-items:center;justify-content:center}
.item img{width:100%;height:100%;object-fit:cover;border-radius:8px}
.item .content{flex:1;display:flex;flex-direction:column;justify-content:space-between}
.tag{position:absolute;right:10px;top:10px;padding:6px 8px;border-radius:8px;font-size:12px;background:rgba(0,0,0,0.25)}
.title{font-weight:800;margin:0 0 6px 0}
.desc{color:var(--muted);font-size:13px;margin-bottom:10px;min-height:36px}
.price-row{display:flex;align-items:center;justify-content:space-between;gap:10px}
.points{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-weight:700}
.buy-row{display:flex;gap:8px;margin-top:10px}
.small{font-size:13px;color:var(--muted)}
.footer{margin-top:18px;padding:16px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);display:flex;justify-content:space-between;align-items:center;gap:12px}
.socials{display:flex;gap:10px}
.social{padding:8px 10px;border-radius:10px;background:rgba(255,255,255,0.03);color:var(--white);font-weight:600}
.modal{position:fixed;inset:0;background:linear-gradient(90deg,rgba(2,6,23,0.7),rgba(2,6,23,0.85));display:flex;align-items:center;justify-content:center;z-index:60}
.box{background:linear-gradient(180deg,#041227,#071430);padding:18px;border-radius:12px;max-width:720px;width:96%}
.input, .input-compact, .textarea{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--white);margin-top:8px}
.input-compact{padding:8px;width:140px}
.textarea{min-height:80px}
.link-out{display:inline-block;padding:8px 12px;border-radius:8px;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#04233b;font-weight:700;text-decoration:none}
.notice{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;color:var(--muted);margin-top:12px}
.hidden{display:none}
.legend{font-size:13px;color:var(--muted);margin-top:8px}
.review{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;margin-top:8px}
.stars{color:#ffd166;font-weight:700}
@media(max-width:900px){.grid{grid-template-columns:1fr;}.card-grid{grid-template-columns:1fr}.item{flex-direction:row}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="brand">
      <div class="logo">MK</div>
      <div>
        <div class="title">Market ‚Äî –ø—Ä–æ–µ–∫—Ç –ø—Ä–æ–¥–∞–∂–∏</div>
        <div class="small">–ü—Ä–æ–¥–∞–≤–∞–π –∏–¥–µ–∏, —Ñ–∏–ª—å–º—ã, –∫–Ω–∏–≥–∏ –∏ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫—É</div>
      </div>
    </div>
    <div class="menu">
      <button class="btn" id="open-main">–¢–æ–≤–∞—Ä—ã</button>
      <button class="btn-ghost" id="open-secret">–°–µ–∫—Ä–µ—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä (–ø–æ –∫–æ–¥—É)</button>
      <button class="btn-ghost" id="reset-purchase">–°–±—Ä–æ—Å–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</button>
    </div>
  </div>

  <div class="grid">
    <div class="main" id="main-area">
      <div class="section-header">
        <div>
          <div style="font-weight:800;font-size:18px">–ì–ª–∞–≤–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω</div>
          <div class="legend">–í—ã–±–∏—Ä–∞–π —Ç–æ–≤–∞—Ä, –Ω–∞–∂–∏–º–∞–π ¬´–ö—É–ø–∏—Ç—å¬ª, –≤–≤–æ–¥–∏ –∫–æ–¥, –ø–æ–ª—É—á–∞–π —Å—Å—ã–ª–∫—É –∏ –±–∞–ª–ª—ã</div>
        </div>
        <div class="tabs">
          <button class="tab active" data-cat="ideas">–ò–¥–µ–∏</button>
          <button class="tab" data-cat="films">–§–∏–ª—å–º—ã</button>
          <button class="tab" data-cat="books">–ö–Ω–∏–≥–∏</button>
        </div>
      </div>

      <div class="hero">
        <div class="text">
          <h2>–¢–æ–≤–∞—Ä—ã –¥–ª—è –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –∏ –∏–¥–µ–π</h2>
          <p>–ö–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä –∏–º–µ–µ—Ç –æ—Ü–µ–Ω–∫—É –ø–æ 100-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ (–≤ –æ—Å–Ω–æ–≤–Ω–æ–º 85+). –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä –≤–≤–µ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä–æ–≤–æ–π –∫–æ–¥ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è ¬´–ö—É–ø–∏—Ç—å¬ª. –ê–≤—Ç–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —á–∞—Å—Ç—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞.</p>
          <div class="cta">
            <button class="btn" onclick="scrollToCatalog()">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–æ–≤–∞—Ä–∞–º</button>
          </div>
        </div>
        <div>
          <div style="width:84px;height:84px;border-radius:10px;background:linear-gradient(135deg,#fff2, #fff1);display:flex;align-items:center;justify-content:center;font-weight:700;color:#021426">üåü</div>
        </div>
      </div>

      <div id="catalog" class="card-grid"></div>

      <div class="footer">
        <div>
          <div style="font-weight:700">–û –Ω–∞—Å</div>
          <div class="small">–Ø ‚Äî –∞–≤—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞. –ó–¥–µ—Å—å –ø—Ä–æ–¥–∞—é –∏–¥–µ–∏, –º–æ—Ç–∏–≤–∞—Ü–∏—é –∏ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫—É. –ê–≤—Ç–æ—Ä—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Ç–æ–≤–∞—Ä–æ–≤.</div>
        </div>
        <div class="socials">
          <div class="social">Instagram</div>
          <div class="social">Telegram</div>
          <div class="social">VK</div>
        </div>
      </div>
    </div>

    <div class="sidebar">
      <div style="font-weight:800;font-size:16px">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
      <div class="notice">–í –ø–µ—Ä–≤–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∞–≤—Ç–æ—Ä–æ–º. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Å—ã–ª–∫–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º –∫–æ–¥ —É –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞. –¶–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã –≤ –±–∞–ª–ª–∞—Ö –∏ —Ç–µ–Ω–≥–µ.</div>
      <div style="margin-top:12px">
        <div style="font-weight:700">–ö–æ—Ä–∑–∏–Ω–∞</div>
        <div id="cart" class="legend">–ü–æ–∫–∞ –ø–æ–∫—É–ø–æ–∫ –Ω–µ—Ç</div>
      </div>
      <div style="margin-top:14px">
        <div style="font-weight:700">–°—Ç–∞—Ç—É—Å</div>
        <div id="status" class="legend">–ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–∞–≤–∞—Ç—å</div>
      </div>
    </div>
  </div>
</div>

<div id="modal" class="modal hidden">
  <div class="box">
    <div id="modal-title" style="font-weight:800;font-size:18px"></div>
    <div id="modal-header" style="display:flex;gap:12px;margin-top:8px;align-items:center">
      <div style="width:120px;height:80px;border-radius:8px;overflow:hidden;background:#000"><img id="modal-img" src="" alt="" style="width:100%;height:100%;object-fit:cover"/></div>
      <div style="flex:1">
        <div id="modal-desc" class="small"></div>
        <div style="margin-top:8px"><span style="font-weight:700">–ê–≤—Ç–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç:</span> <span id="modal-author" class="small"></span></div>
        <div style="margin-top:8px"><span style="font-weight:700">–ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –∫—É–ø–∏—Ç—å:</span><div id="modal-why" class="small" style="margin-top:6px"></div></div>
      </div>
    </div>

    <div style="display:flex;justify-content:space-between;gap:10px;margin-top:12px">
      <div><span class="small">–ë–∞–ª–ª—ã</span><div id="modal-points" class="points" style="margin-top:6px">0/100</div></div>
      <div><span class="small">–°—Ç–æ–∏–º–æ—Å—Ç—å</span><div id="modal-tenge" class="points" style="margin-top:6px">0 ‚Ç∏</div></div>
    </div>

    <div style="margin-top:12px">
      <input id="code-input" class="input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä–æ–≤–æ–π –∫–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏" inputmode="numeric" />
      <div style="display:flex;gap:8px;margin-top:10px;justify-content:flex-end">
        <button class="btn-ghost" id="modal-close">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn" id="modal-check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥</button>
      </div>
      <div id="modal-result" class="small legend hidden" style="margin-top:12px"></div>
    </div>

    <div style="margin-top:14px">
      <div style="font-weight:700">–û—Ç–∑—ã–≤—ã</div>
      <div id="author-reco" class="review" style="margin-top:8px;font-weight:700"></div>
      <div id="reviews-list" style="margin-top:8px"></div>
      <div style="margin-top:10px;font-weight:700">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</div>
      <input id="rv-name" class="input" placeholder="–ò–º—è" />
      <select id="rv-stars" class="input" style="margin-top:8px">
        <option value="5">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ (5)</option>
        <option value="4">‚òÖ‚òÖ‚òÖ‚òÖ (4)</option>
        <option value="3">‚òÖ‚òÖ‚òÖ (3)</option>
        <option value="2">‚òÖ‚òÖ (2)</option>
        <option value="1">‚òÖ (1)</option>
      </select>
      <textarea id="rv-text" class="textarea" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"></textarea>
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:8px">
        <button class="btn" id="rv-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
      </div>
    </div>

  </div>
</div>

<div id="secret-modal" class="modal hidden">
  <div class="box">
    <div style="font-weight:800;font-size:18px">–í—Ö–æ–¥ –≤ –°–µ–∫—Ä–µ—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä</div>
    <div class="small" style="margin-top:8px">–í–≤–µ–¥–∏—Ç–µ 4-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Å–µ–∫—Ü–∏—é (3 –ø–æ–ø—ã—Ç–∫–∏).</div>
    <input id="secret-input" class="input-compact" placeholder="____" maxlength="4" inputmode="numeric" />
    <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px">
      <button class="btn-ghost" id="secret-cancel">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn" id="secret-go">–í–æ–π—Ç–∏</button>
    </div>
    <div id="secret-msg" class="legend" style="margin-top:10px"></div>
  </div>
</div>

<div id="secret-area" class="modal hidden" style="align-items:flex-start;overflow:auto;padding-top:40px">
  <div class="box" style="max-width:960px;width:96%;margin-bottom:40px">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div style="font-weight:900;font-size:20px">–°–µ–∫—Ä–µ—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä ‚Äî –§–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã</div>
      <div style="display:flex;gap:8px">
        <button class="btn-ghost" id="secret-exit">–í—ã–π—Ç–∏</button>
      </div>
    </div>
    <div class="notice" style="margin-top:12px">–≠—Ç–∏ —Ç–æ–≤–∞—Ä—ã ‚Äî —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è. –î–ª—è –≤—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è 4-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥.</div>
    <div style="margin-top:16px;display:grid;grid-template-columns:repeat(2,1fr);gap:12px">
      <div style="background:linear-gradient(180deg,#021f2f,#042436);padding:14px;border-radius:12px">
        <div style="font-weight:800">–¢–∞–±–ª–µ—Ç–∫–∏ —ç–º–æ—Ü–∏–π</div>
        <div class="small" style="margin-top:8px">–¢—Ä–∏ –≤–∏–¥–∞: –†–∞–¥–æ—Å—Ç—å, –°–º–µ—Ö, –°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ.</div>
        <div style="margin-top:10px;display:flex;gap:8px">
          <button class="btn" onclick="openSecretItem('pill1')">–†–∞–¥–æ—Å—Ç—å</button>
          <button class="btn" onclick="openSecretItem('pill2')">–°–º–µ—Ö</button>
          <button class="btn" onclick="openSecretItem('pill3')">–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ</button>
        </div>
      </div>
      <div style="background:linear-gradient(180deg,#1b1430,#2a1b3d);padding:14px;border-radius:12px">
        <div style="font-weight:800">–ü–∞—Ä—Ñ—é–º—ã —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π</div>
        <div class="small" style="margin-top:8px">–¢—Ä–∏ –ø–∞—Ä—Ñ—é–º–∞: —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ, —É–º.</div>
        <div style="margin-top:10px;display:flex;gap:8px">
          <button class="btn" onclick="openSecretItem('perfume1')">–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</button>
          <button class="btn" onclick="openSecretItem('perfume2')">–ü—Ä–∏—Ç—è–∂–µ–Ω–∏–µ</button>
          <button class="btn" onclick="openSecretItem('perfume3')">–£–º</button>
        </div>
      </div>
      <div style="grid-column:1/3;background:linear-gradient(180deg,#20161f,#2d1f2a);padding:14px;border-radius:12px">
        <div style="font-weight:900;font-size:18px">–ê—Ä—Ç–µ—Ñ–∞–∫—Ç ‚Äî –û—á–∫–∏ –∏—Å—Ç–∏–Ω—ã</div>
        <div class="small" style="margin-top:8px">–ê—Ä—Ç–µ—Ñ–∞–∫—Ç: —Ä–µ–∂–∏–º ¬´–∏—Å—Ç–∏–Ω–∞¬ª –∏ —Ä–µ–∂–∏–º ¬´–º—ã—Å–ª–∏¬ª. –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–¥–µ—è; —Ü–µ–Ω—ã —Ä—É–±–µ–∂–Ω—ã–µ.</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button class="btn" onclick="openSecretItem('glasses')">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—á–∫–∏</button>
        </div>
      </div>
    </div>
    <div id="secret-item-modal" class="hidden" style="margin-top:12px;padding:12px;border-radius:10px;background:linear-gradient(90deg,#0008,#0006)"></div>
  </div>
</div>

<script>
const DATA = {
  items: [
  {id:'idea1',cat:'ideas',title:'–ò–¥–µ—è: –®–ø–∞—Ä–≥–∞–ª–∫–∞ —É—Å–ø–µ—Ö–∞',desc:'–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –ø—Ä–∏—ë–º–æ–≤ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',points:88,price:4400,code:'1010',link:'https://medium.com/search?q=–®–ø–∞—Ä–≥–∞–ª–∫–∞+—É—Å–ø–µ—Ö–∞',img:'https://picsum.photos/seed/idea1/300/200'},
  {id:'idea2',cat:'ideas',title:'–ò–¥–µ—è: –ú–∏–Ω–∏-–±–∏–∑–Ω–µ—Å –Ω–∞ –¥–æ–º—É',desc:'–ü–æ—à–∞–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞',points:86,price:4100,code:'1011',link:'https://medium.com/search?q=–º–∏–Ω–∏+–±–∏–∑–Ω–µ—Å+–Ω–∞+–¥–æ–º—É',img:'https://picsum.photos/seed/idea2/300/200'},
  {id:'idea3',cat:'ideas',title:'–ò–¥–µ—è: –ö—É—Ä—Å –ø–æ —Å–∞–º–æ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏',desc:'30-–¥–Ω–µ–≤–Ω—ã–π –ø–ª–∞–Ω –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã –∏ –ø—Ä–∏–≤—ã—á–µ–∫',points:90,price:5000,code:'1012',link:'https://medium.com/search?q=–∫—É—Ä—Å+–ø–æ+—Å–∞–º–æ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏',img:'https://picsum.photos/seed/idea3/300/200'},
  {id:'idea4',cat:'ideas',title:'–ò–¥–µ—è: –ú–æ–±–∏–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç',desc:'–ö–æ–Ω—Ü–µ–ø—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø—Ä–æ—Å—Ç—ã–º MVP',points:85,price:3950,code:'1013',link:'https://medium.com/search?q=–º–æ–±–∏–ª—å–Ω—ã–π+–ø—Ä–æ–µ–∫—Ç+mvp',img:'https://picsum.photos/seed/idea4/300/200'},
  {id:'idea5',cat:'ideas',title:'–ò–¥–µ—è: –ö–æ–º—å—é–Ω–∏—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞',desc:'–ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏ —É–¥–µ—Ä–∂–∞—Ç—å –∞—É–¥–∏—Ç–æ—Ä–∏—é',points:87,price:4250,code:'1014',link:'https://medium.com/search?q=–∫–æ–º—å—é–Ω–∏—Ç–∏+–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞',img:'https://picsum.photos/seed/idea5/300/200'},
  {id:'idea6',cat:'ideas',title:'–ò–¥–µ—è: –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ä—á',desc:'–ö–æ–Ω—Ü–µ–ø—Ç —Ç–æ–≤–∞—Ä–∞ —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º –ø—Ä–∏–±—ã–ª–∏',points:85,price:3800,code:'1015',link:'https://medium.com/search?q=–∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π+–º–µ—Ä—á',img:'https://picsum.photos/seed/idea6/300/200'},

  {id:'film1',cat:'films',title:'–§–∏–ª—å–º: –í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ 1',desc:'–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π —Ñ–∏–ª—å–º ‚Äî 90 –º–∏–Ω—É—Ç —ç–Ω–µ—Ä–≥–∏–∏',points:91,price:4550,code:'2010',link:'https://www.youtube.com/results?search_query=–§–∏–ª—å–º+–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ+1',img:'https://picsum.photos/seed/film1/300/200'},
  {id:'film2',cat:'films',title:'–§–∏–ª—å–º: –í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ 2',desc:'–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ –∏ —Ä–æ—Å—Ç',points:89,price:4350,code:'2011',link:'https://www.youtube.com/results?search_query=–§–∏–ª—å–º+–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ+2',img:'https://picsum.photos/seed/film2/300/200'},
  {id:'film3',cat:'films',title:'–§–∏–ª—å–º: –î–µ–π—Å—Ç–≤—É–π',desc:'–ö–æ—Ä–æ—Ç–∫–∏–π —Ñ–∏–ª—å–º –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –¥–Ω—è',points:88,price:4200,code:'2012',link:'https://www.youtube.com/results?search_query=–§–∏–ª—å–º+–î–µ–π—Å—Ç–≤—É–π',img:'https://picsum.photos/seed/film3/300/200'},
  {id:'film4',cat:'films',title:'–§–∏–ª—å–º: –ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ',desc:'–û —Ç–æ–º, –∫–∞–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –ª—É—á—à–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å',points:90,price:4450,code:'2013',link:'https://www.youtube.com/results?search_query=–§–∏–ª—å–º+–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ',img:'https://picsum.photos/seed/film4/300/200'},
  {id:'film5',cat:'films',title:'–§–∏–ª—å–º: –ù–∞ –≥—Ä–∞–Ω–∏',desc:'–ú–æ—Ç–∏–≤–∞—Ç–æ—Ä –ø—Ä–æ —Ä–∏—Å–∫–∏ –∏ –Ω–∞–≥—Ä–∞–¥—ã',points:85,price:4000,code:'2014',link:'https://www.youtube.com/results?search_query=–§–∏–ª—å–º+–ù–∞+–≥—Ä–∞–Ω–∏',img:'https://picsum.photos/seed/film5/300/200'},
  {id:'film6',cat:'films',title:'–§–∏–ª—å–º: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞',desc:'–û –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø–∞—É–∑ –∏ –¥–µ–π—Å—Ç–≤–∏–π',points:86,price:4150,code:'2015',link:'https://www.youtube.com/results?search_query=–§–∏–ª—å–º+–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞',img:'https://picsum.photos/seed/film6/300/200'},

  {id:'book1',cat:'books',title:'–ö–Ω–∏–≥–∞: –ú–æ—Ç–∏–≤–∞—Ü–∏—è 101',desc:'–ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏',points:87,price:4300,code:'3010',link:'https://www.google.com/search?tbm=bks&q=–ú–æ—Ç–∏–≤–∞—Ü–∏—è+101',img:'https://picsum.photos/seed/book1/300/200'},
  {id:'book2',cat:'books',title:'–ö–Ω–∏–≥–∞: –†–µ–∂–∏–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è',desc:'–ü–ª–∞–Ω –Ω–∞ 66 –¥–Ω–µ–π –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π',points:92,price:4600,code:'3011',link:'https://www.google.com/search?tbm=bks&q=–†–µ–∂–∏–º+–ø–æ–±–µ–¥–∏—Ç–µ–ª—è',img:'https://picsum.photos/seed/book2/300/200'},
  {id:'book3',cat:'books',title:'–ö–Ω–∏–≥–∞: –ú–∞–ª—ã–µ —à–∞–≥–∏',desc:'–ö–∞–∫ –º–∞–ª–µ–Ω—å–∫–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ –¥–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç',points:85,price:3900,code:'3012',link:'https://www.google.com/search?tbm=bks&q=–ú–∞–ª—ã–µ+—à–∞–≥–∏',img:'https://picsum.photos/seed/book3/300/200'}
],
  secret:{
    key:'4321',
    attempts:3,
    items:{
      pill1:{title:'–¢–∞–±–ª–µ—Ç–∫–∞: –†–∞–¥–æ—Å—Ç—å',desc:'–ú—è–≥–∫–∞—è –≤–æ–ª–Ω–∞ –ø–æ–¥—ä—ë–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è; –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è.',points:95,price:150000,code:'9001'},
      pill2:{title:'–¢–∞–±–ª–µ—Ç–∫–∞: –°–º–µ—Ö',desc:'–í—ã–∑—ã–≤–∞–µ—Ç –∏—Å–∫—Ä–µ–Ω–Ω–µ–µ –≤–µ—Å–µ–ª—å–µ –∏ –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–±—ã—Ç—å —Ç—Ä–µ–≤–æ–≥–∏; —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ.',points:96,price:120000,code:'9002'},
      pill3:{title:'–¢–∞–±–ª–µ—Ç–∫–∞: –°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ',desc:'–ì–ª—É–±–æ–∫–æ–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ; —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è.',points:95,price:130000,code:'9003'},
      perfume1:{title:'–ü–∞—Ä—Ñ—é–º: –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å',desc:'–ê—Ä–æ–º–∞—Ç, —É—Å–∏–ª–∏–≤–∞—é—â–∏–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –æ–±—â–µ–Ω–∏–∏.',points:97,price:98000,code:'9101'},
      perfume2:{title:'–ü–∞—Ä—Ñ—é–º: –ü—Ä–∏—Ç—è–∂–µ–Ω–∏–µ',desc:'–ù–æ—Ç–∞ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –æ–∫—Ä—É–∂–∞—é—â–∏—Ö.',points:96,price:120000,code:'9102'},
      perfume3:{title:'–ü–∞—Ä—Ñ—é–º: –£–º',desc:'–ê—Ä–æ–º–∞—Ç, —Å–æ–∑–¥–∞—é—â–∏–π —Ñ–æ–∫—É—Å –∏ —è—Å–Ω–æ—Å—Ç—å (–æ–±—Ä–∞–∑–Ω–æ).',points:98,price:140000,code:'9103'},
      glasses:{title:'–û—á–∫–∏ –∏—Å—Ç–∏–Ω—ã',desc:'–ê—Ä—Ç–µ—Ñ–∞–∫—Ç: —Ä–µ–∂–∏–º ¬´–∏—Å—Ç–∏–Ω–∞¬ª –∏ —Ä–µ–∂–∏–º ¬´–º—ã—Å–ª–∏¬ª. –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–¥–µ—è.',points:100,price:999000,code:'9999'}
    }
  }
};

let currentCategory = 'ideas';
let openedItem = null;
let purchases = JSON.parse(localStorage.getItem('purchases')||'[]');
let reviews = JSON.parse(localStorage.getItem('reviews')||'{}');

function formatTenge(n){return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ") + ' ‚Ç∏'}

function saveReviews(){localStorage.setItem('reviews',JSON.stringify(reviews))}

function getReviews(id){return reviews[id]||[]}

function addReview(id,name,stars,text){
  if(!reviews[id]) reviews[id]=[];
  reviews[id].unshift({name,stars,text,time:Date.now()});
  saveReviews();
}

function renderCatalog(){
  const catalog = document.getElementById('catalog');
  catalog.innerHTML = '';
  const visible = DATA.items.filter(i=>i.cat===currentCategory);
  visible.forEach(it=>{
    const el = document.createElement('div');
    el.className='item';
    el.innerHTML = `
      <div class="left"><img src="${it.img}" alt="${it.title}"/></div>
      <div class="content">
        <div>
          <div class="tag">${it.cat==='ideas'?'IDEA': it.cat==='films'?'FILM':'BOOK'}</div>
          <div class="title">${it.title}</div>
          <div class="desc">${it.desc}</div>
        </div>
        <div>
          <div class="price-row">
            <div class="points">${it.points}/100</div>
            <div class="small">${formatTenge(it.price)}</div>
          </div>
          <div class="buy-row">
            <button class="btn" onclick="openBuy('${it.id}')">–ö—É–ø–∏—Ç—å</button>
            <button class="btn-ghost" onclick="previewLink(event,'${it.id}')">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
            <button class="btn-ghost" onclick="openReviews('${it.id}')">–û—Ç–∑—ã–≤—ã</button>
          </div>
        </div>
      </div>
    `;
    catalog.appendChild(el);
  });
}

function previewLink(e,id){
  e.preventDefault();
  alert('–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏ –Ω—É–∂–Ω–æ –∫—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä –∏ –≤–≤–µ—Å—Ç–∏ –∫–æ–¥.');
}

function openBuy(id){
  openedItem = DATA.items.find(x=>x.id===id);
  document.getElementById('modal-title').innerText = openedItem.title;
  document.getElementById('modal-desc').innerText = openedItem.desc;
  document.getElementById('modal-img').src = openedItem.img;
  document.getElementById('modal-points').innerText = openedItem.points + '/100';
  document.getElementById('modal-tenge').innerText = formatTenge(openedItem.price);
  document.getElementById('modal-author').innerText = '–ê–≤—Ç–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä –∫–∞–∫ –ø–æ–ª–µ–∑–Ω—ã–π –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π.';
  document.getElementById('modal-why').innerText = whyBuyText(openedItem);
  document.getElementById('modal-result').classList.add('hidden');
  document.getElementById('code-input').value='';
  renderReviewsForModal(openedItem.id);
  document.getElementById('modal').classList.remove('hidden');
}

function whyBuyText(it){
  return `–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ: –ø–æ–Ω—è—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –≥–æ—Ç–æ–≤—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—è; –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∏–¥–µ–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç. –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å: —Å–æ–±—Ä–∞–Ω–Ω—ã–π –∞–≤—Ç–æ—Ä–æ–º –Ω–∞–±–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –∏ –¥–∞—ë—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏. –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –≠—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–æ—Å—Ç–∞ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.`;
}

document.getElementById('modal-close').addEventListener('click',()=>{document.getElementById('modal').classList.add('hidden')});
document.getElementById('modal-check').addEventListener('click',()=>{
  const code = document.getElementById('code-input').value.trim();
  const res = document.getElementById('modal-result');
  if(!code){res.innerText='–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥.';res.classList.remove('hidden');return}
  if(openedItem && code === openedItem.code){
    res.innerHTML = '‚úÖ –ö–æ–¥ –≤–µ—Ä–Ω—ã–π. –°—Å—ã–ª–∫–∞: <a class="link-out" target="_blank" href="'+openedItem.link+'">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–æ–≤–∞—Ä—É</a>';
    res.classList.remove('hidden');
    purchases.push({id:openedItem.id,time:Date.now()});
    localStorage.setItem('purchases',JSON.stringify(purchases));
    updateCart();
  } else {
    res.innerText='–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥.';
    res.classList.remove('hidden');
  }
});

function renderReviewsForModal(id){
  const list = document.getElementById('reviews-list');
  list.innerHTML = '';
  const arr = getReviews(id);
  arr.slice(0,8).forEach(r=>{
    const el = document.createElement('div');
    el.className='review';
    el.innerHTML = `<div style="font-weight:700">${escapeHtml(r.name)} <span class="stars"> ${'‚òÖ'.repeat(r.stars)}</span></div><div class="small" style="margin-top:6px">${escapeHtml(r.text)}</div>`;
    list.appendChild(el);
  });
  document.getElementById('author-reco').innerText = '–ê–≤—Ç–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä.';
}

document.getElementById('rv-submit').addEventListener('click',()=>{
  const name = (document.getElementById('rv-name').value||'–ü–æ–∫—É–ø–∞—Ç–µ–ª—å').trim();
  const stars = parseInt(document.getElementById('rv-stars').value||5,10);
  const text = (document.getElementById('rv-text').value||'').trim();
  if(!openedItem){alert('–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–æ–≤–∞—Ä');return}
  if(!text){alert('–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π');return}
  addReview(openedItem.id,name,stars,text);
  renderReviewsForModal(openedItem.id);
  document.getElementById('rv-name').value='';document.getElementById('rv-text').value='';
});

function openReviews(id){
  const it = DATA.items.find(x=>x.id===id);
  openBuy(id);
}

function updateCart(){
  const cart = document.getElementById('cart');
  if(purchases.length===0){cart.innerText='–ü–æ–∫–∞ –ø–æ–∫—É–ø–æ–∫ –Ω–µ—Ç';document.getElementById('status').innerText='–ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–∞–≤–∞—Ç—å';return}
  cart.innerHTML = purchases.map(p => {
    const it = DATA.items.find(x=>x.id===p.id) || {title:p.id,price:0,points:0};
    return `<div style="margin-bottom:6px;font-weight:700">${it.title} ‚Äî ${it.points}/100 ‚Äî ${formatTenge(it.price)}</div>`;
  }).join('');
  document.getElementById('status').innerText = '–ï—Å—Ç—å –ø–æ–∫—É–ø–∫–∏';
}

document.querySelectorAll('.tab').forEach(t=>{
  t.addEventListener('click', ()=> {
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    currentCategory = t.getAttribute('data-cat');
    renderCatalog();
  });
});

function scrollToCatalog(){document.getElementById('catalog').scrollIntoView({behavior:'smooth'})}
document.getElementById('open-main').addEventListener('click',()=>{document.getElementById('main-area').scrollIntoView({behavior:'smooth'})})

document.getElementById('open-secret').addEventListener('click',()=>{
  document.getElementById('secret-modal').classList.remove('hidden');
});

let secretAttempts = DATA.secret.attempts;
document.getElementById('secret-go').addEventListener('click',()=>{
  const v = document.getElementById('secret-input').value.trim();
  const msg = document.getElementById('secret-msg');
  if(v===DATA.secret.key){
    document.getElementById('secret-modal').classList.add('hidden');
    document.getElementById('secret-area').classList.remove('hidden');
    msg.innerText='';
  } else {
    secretAttempts--;
    if(secretAttempts<=0){msg.innerText='–ö–æ–¥—ã –ø–æ–ø—ã—Ç–æ–∫ –∏—Å—á–µ—Ä–ø–∞–Ω—ã.'; document.getElementById('secret-go').disabled=true; return}
    msg.innerText = '–ù–µ–≤–µ—Ä–Ω–æ. –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: '+secretAttempts;
  }
});
document.getElementById('secret-cancel').addEventListener('click',()=>{document.getElementById('secret-modal').classList.add('hidden')});
document.getElementById('secret-exit').addEventListener('click',()=>{
  document.getElementById('secret-area').classList.add('hidden');
});

function openSecretItem(key){
  const s = DATA.secret.items[key];
  const modal = document.getElementById('secret-item-modal');
  modal.classList.remove('hidden');
  modal.innerHTML = `<div style="font-weight:800">${s.title}</div>
    <div class="small" style="margin-top:8px">${s.desc}</div>
    <div style="margin-top:10px" class="small">–û—Ü–µ–Ω–∫–∞: ${s.points}/100 ‚Äî –¶–µ–Ω–∞: ${formatTenge(s.price)}</div>
    <div style="margin-top:10px;display:flex;gap:8px">
      <input id="secret-code-input" class="input-compact" placeholder="–ö–æ–¥" maxlength="6" />
      <button class="btn" onclick="checkSecretCode('${key}')">–í–≤–µ—Å—Ç–∏</button>
    </div>
    <div id="secret-result" class="legend" style="margin-top:8px"></div>`;
}

function checkSecretCode(key){
  const val = document.getElementById('secret-code-input').value.trim();
  const res = document.getElementById('secret-result');
  const s = DATA.secret.items[key];
  if(val===s.code){
    res.innerHTML = '‚úÖ –ö–æ–¥ –ø—Ä–∏–Ω—è—Ç. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∫–∏: <a class="link-out" target="_blank" href="#">–ü–µ—Ä–µ–π—Ç–∏</a>';
    purchases.push({id:'secret:'+key,time:Date.now()});
    localStorage.setItem('purchases',JSON.stringify(purchases));
    updateCart();
  } else {
    res.innerText = '–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥.';
  }
}

document.getElementById('reset-purchase').addEventListener('click',()=>{
  purchases = []; localStorage.removeItem('purchases'); updateCart();
  alert('–ü–æ–∫—É–ø–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã');
});

function escapeHtml(str){return String(str).replace(/[&<>"']/g, s=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[s]))}

renderCatalog();
updateCart();
</script>
</body>
</html>
